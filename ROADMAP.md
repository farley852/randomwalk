# Roadmap

現状（Phase 1 完了）からの次ステップを優先度順に整理する。

## 現状サマリ

| 領域 | 状態 |
|------|------|
| コア機能（ウォーク生成・アニメーション・ヒートマップ・トレイルフェード・GIFエクスポート） | 完了 |
| TypeScript strict mode | 有効 |
| パフォーマンス最適化（DDA・OffscreenCanvas・トレイルループ） | 完了 |
| テスト | 未導入 |
| Lint / Format | 未導入 |
| CI/CD | 未導入 |
| README / デプロイ | 未導入 |

---

## Phase 2: 品質基盤

コア機能が安定したので、変更に強い基盤を先に整える。

### 2-1. テスト導入（Vitest）

- `vitest` を devDependencies に追加
- 対象（優先順）:
  1. `prng.ts` — 同じシードで同じ出力が返ることの検証
  2. `walk.ts` — ステップ数・座標の正当性
  3. `heatmap.ts` — DDA ラスタライズの境界値・safety limit
  4. `camera.ts` — バウンディングボックスからのビューポート計算
- `npm test` スクリプト追加
- AGENTS.md のテストフレームワーク欄を更新

### 2-2. Lint / Format 導入

- ESLint (flat config) + Prettier
- `npm run lint` / `npm run format` スクリプト追加
- 既存コードへの一括適用 & 修正コミット

### 2-3. CI（GitHub Actions）

- PR / push 時に `tsc --noEmit` + `vitest run` + `vite build` を実行
- 失敗時にマージをブロック

---

## Phase 3: UX 改善

ユーザー体験の向上。視覚的なインパクトが大きく、実装コストが低いものから。

### 3-1. キーボードショートカット

- `Space` → Play / Pause
- `R` → Reset
- `E` → Export GIF
- UI にショートカットヒントを表示

### 3-2. URL パラメータ共有

- `?seed=42&steps=500&stepLength=5` のように URL にパラメータを埋め込む
- ページ読み込み時に URL から復元 → 同じウォークを共有可能
- パラメータ変更時に `history.replaceState` で URL を同期

### 3-3. 統計情報パネル

- 現在の歩数 / 全歩数
- 原点からの直線距離（ユークリッド距離）
- 最大到達距離
- 総歩行距離
- キャンバス下部またはサイドパネルにリアルタイム表示

### 3-4. レスポンシブ対応強化

- モバイル端末でのタッチ操作対応
- コントロールパネルの折りたたみ / ドロワー化
- キャンバスサイズの柔軟な調整

---

## Phase 4: シミュレーション拡張

ウォークのバリエーションや描画の幅を広げる。

### 4-1. ウォークタイプの追加

- **格子ウォーク（Lattice Walk）**: 上下左右の4方向のみ
- **Levy Flight**: ステップ長がべき乗分布に従う（長い跳躍あり）
- **自己回避ウォーク（Self-Avoiding Walk）**: 訪問済みセルを避ける
- UI にウォークタイプのドロップダウンを追加

### 4-2. 複数ウォーク同時表示

- 同じパラメータでシードだけ変えた複数ウォークを重ねて描画
- 色分けで識別
- ウォーク数の制御 UI

### 4-3. ズーム・パン操作

- マウスホイールでズーム
- ドラッグでパン
- ダブルクリックでフィットリセット

### 4-4. 背景グリッド表示

- 格子ウォーク時のグリッドライン描画
- 座標軸の表示（原点を明示）

---

## Phase 5: 配布・公開

### 5-1. README.md 作成

- プロジェクト概要・スクリーンショット / GIF
- 使い方・機能一覧
- 開発・ビルド手順

### 5-2. GitHub Pages デプロイ

- `vite build` の出力を GitHub Pages にデプロイ
- GitHub Actions でメインブランチへのマージ時に自動デプロイ

### 5-3. OGP メタデータ

- `og:image` / `og:title` / `og:description` の設定
- URL 共有時のプレビュー表示

---

## 優先度の考え方

```
Phase 2 (品質基盤) → Phase 3 (UX) → Phase 4 (シミュレーション拡張) → Phase 5 (配布)
```

- Phase 2 は他のすべての変更を安全に進めるための前提条件
- Phase 3 はユーザーが実感しやすい改善で、既存アーキテクチャ内で完結する
- Phase 4 はアーキテクチャ拡張（`walk.ts` の抽象化など）が必要になる可能性がある
- Phase 5 はいつ実施してもよいが、Phase 3 以降のほうが見栄えが良い
